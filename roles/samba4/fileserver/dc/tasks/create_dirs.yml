- name: Create Files Directory
  file:
    path: "{{ fileserver.files_dir }}"
    state: directory
    group: "Domain Admins"
  notify: 
    - Restart Samba

- name: Create Audit Directory
  file:
    path: "{{ fileserver.files_dir }}/Audit"
    state: directory
    group: "Domain Admins"
  when: audit.enable is defined

- name: Create Home Users Directory
  file:
    path: "{{ fileserver.files_dir }}/Users"
    state: directory
    group: "Domain Admins"
  when: fileserver.home_user_dir is defined

- name: Create Recycle Directory
  file:
    path: "{{ fileserver.files_dir }}/Recycle"
    state: directory
    group: "Domain Admins"
  when: fileserver.recycle is defined

- name: Create Public Directory
  file:
    path: "{{ fileserver.files_dir }}/Public"
    state: directory
    group: "Domain Admins"
  when: fileserver.public_dir is defined

- name: Set Permission Audit
  shell: /usr/local/samba/bin/samba-tool ntacl set "O:LAG:DAD:PAI(A;OICI;0x001f01ff;;;DA)(A;OICI;0x001201bf;;;DU)" {{ fileserver.files_dir }}/Audit
  when: audit.enable is defined

- name: Set Permission Home Users
  shell: /usr/local/samba/bin/samba-tool ntacl set "O:LAG:DAD:PAI(A;OICI;0x001f01ff;;;DA)(A;;0x001200a1;;;DU)" {{ fileserver.files_dir }}/Users
  when: fileserver.home_user_dir is defined

- name: Set Permission Recycle
  shell: /usr/local/samba/bin/samba-tool ntacl set "O:LAG:DAD:PAI(A;OICI;0x001f01ff;;;DA)(A;OICI;0x001201bf;;;DU)" {{ fileserver.files_dir }}/Recycle
  when: fileserver.recycle is defined

