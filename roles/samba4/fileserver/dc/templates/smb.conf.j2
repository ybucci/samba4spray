################# Global Configuration ##################
# Do not modify!!! unless you know what you're doing

[global]
bind interfaces only = Yes
interfaces = lo {{ target_interface }}
netbios name = {{ inventory_hostname|upper }}
realm = {{ samba_domain|upper }}
server role = active directory domain controller
server services = s3fs, rpc, nbt, wrepl, ldap, cldap, kdc, drepl, winbindd, ntp_signd, kcc, dnsupdate
workgroup = {{ workgroup }}
idmap_ldb:use rfc2307 = yes
vfs objects = dfs_samba4 acl_xattr {% if audit.enable %}full_audit {% endif %}{% if fileserver.recycle %}recycle{% endif %}

{% if audit.enable %}
################# Audit ##########################

log file = {{ fileserver.files_dir }}/Audit/audit.txt
max log size = {{ audit.max_log_size }}
strict sync = yes
sync always = yes
full_audit:sucess  = mkdir, rmdir, read, pread, write, pwrite, rename, unlink, chmod, chown, open, opendir
full_audit:prefix = %u|%I|%m|%p|%P|%S
full_audit:failure = none
full_audit:facility = local5
full_audit:priority = notice

{% endif %}

################# Default Shares ##################
# Do not modify!!! unless you know what you're doing

[sysvol]
path = /var/lib/samba/sysvol
read only = No


[netlogon]
path = /var/lib/samba/sysvol/{{ samba_domain }}/scripts
read only = No


################# Custom Shares ###################

### Example share ###
# [Name_of_your_share]
# path = /Directory/Example
# read only = no
# browseable = yes

{% if fileserver.dc %}
{% if fileserver.public_dir %}
[Public]
path = {{ fileserver.files_dir }}/Public
read only = no
{% endif %}

{% if fileserver.home_user_dir %}
[Users]
path = {{ fileserver.files_dir }}/Users
read only = no
{% endif %}

{% if fileserver.recycle %}
[Recycle]
path = {{ fileserver.files_dir }}/Recycle
read only = no
browseable = no
{% endif %}


{% endif %}