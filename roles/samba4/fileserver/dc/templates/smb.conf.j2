################# Global Parameters #######################
[global]
        bind interfaces only = Yes
        interfaces = lo {{ target_interface }}
        netbios name = {{ inventory_hostname|upper }}
        realm = {{ samba_domain|upper }}
        server role = active directory domain controller
        server services = s3fs, rpc, nbt, wrepl, ldap, cldap, kdc, drepl, winbindd, ntp_signd, kcc, dnsupdate
        workgroup = {{ workgroup|upper }}
        idmap_ldb:use rfc2307 = yes
        winbind use default domain = yes
        winbind enum users = yes
        winbind enum groups = yes
        vfs objects = dfs_samba4, acl_xattr{% if audit.enable is defined %}, full_audit{% endif %}

################# Recycle #######################

# recycle:keeptree = yes
# recycle:versions = yes
# recycle:repository = $DIRETORIO_RAIZ/Lixeira/%U
# recycle:exclude = *.tmp, *.log, *.obj, ~*.*, *.bak
# recycle:exclude_dir = tmp, cache, profiles

{% if audit.enable is defined %}
################# Audit ##########################

        log file = {{ fileserver.files_dir }}/Audit/audit.txt
        max log size = {{ audit.max_log_size }}
        strict sync = yes
        sync always = yes
        full_audit:sucess  = mkdir, rmdir, read, pread, write, pwrite, rename, unlink, chmod, chown, open, opendir
        full_audit:prefix = %u|%I|%m|%p|%P|%S
        full_audit:failure = none
        full_audit:facility = local5
        full_audit:priority = notice

{% endif %}
################# Default Shares ##################

[sysvol]
        path = /var/lib/samba/sysvol
        read only = No

[netlogon]
        path = /var/lib/samba/sysvol/{{ samba_domain }}/scripts
        read only = No

################# Custom Shares ###################

# [Usuarios]
# path = $DIRETORIO_RAIZ/Usuarios
# read only = no
# browseable = no

# [Lixeira]
# path = $DIRETORIO_RAIZ/Lixeira
# read only = no
# browseable = no